#  https://docs.getdbt.com/reference/resource-properties/unit-tests

unit_tests:
  - name: cast_string_date_to_date_type_from_height_source # this is the unique name of the test
    model: stg_gym_app__height # name of the model I'm unit testing
    given: # the mock data for your inputs
      - input: source('gym_app', 'raw_height')
        rows:
          - {date: '01/07/2009', height_unit: 'cm', user_id: 1, height: 170}
    expect: # the expected output given the inputs above
      rows:
        - {created_date: '2009-07-01', user_id: 1, measurement_unit: 'cm', height: 170}